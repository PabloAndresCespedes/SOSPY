<!DOCTYPE html>

<html>
    <head>
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <meta charset="UTF-8">

        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"> 
        <link rel="stylesheet" type="text/css" href="css/index.css">

        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css"/>

        <link rel="stylesheet" type="text/css" href="css/all.css">


        <link rel="stylesheet" type="text/css" href="css/vendor/font-awesome.min.css">
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
       
       
        <script src="js/jquery-2.1.3.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
   
        <script type="text/javascript"></script>

        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/bootstrap-theme.css">
        <script>
          var db=null;
        document.addEventListener("deviceready", onDeviceReady, false);

        function onDeviceReady(){
            console.log("device is ready");
            db = window.sqlitePlugin.openDatabase({name: "sacando.db", createFromLocation: 1});

            if(db!=null){
                listarTodasCiudades();
            }
            else{
                console.log("error al abrir bd");
            }
        }

        function listarTodasCiudades(){
            db.transaction(listar,error);
        }
        
        function listarComisariaTodo(){
            db.transaction(listarComisaria,error);
        }

        function listar(tx){
            tx.executeSql("select ID, DESCRIPCION from DEPARTAMENTOS",[],function(tx,result){
                var ndepartamento=result.rows.length;
                var html="";
                var html2="";
                
                if(ndepartamento > 0){
                    
                    for(var i = 0; i < ndepartamento; i++){
                        var fila=result.rows.item(i);
                        html+="<option value="+fila['ID']+">"+fila['DESCRIPCION']+"</option>";
                    }
                    $('#departamento').html(html);
                                       
                }
                else{
                    console.log("no hay datos");
                }

            });

        }

        function listarComisaria(tx){
            var v_id_com = document.getElementById('departamento').selectedIndex;

            tx.executeSql("select ID, DESCRIPCION from DEPENDENCIAS where ID_DEPARTAMENTO = "+ v_id_com, [],function(tx,result){
                var nComisarias=result.rows.length;
                var html="";
                var html2="";
                
                if(nComisarias > 0){
                    for(var i = 0; i < nComisarias; i++){
                        var fila=result.rows.item(i);
                        html+="<option value="+fila['ID']+">"+fila['DESCRIPCION']+"</option>";
                    }
                    $('#comisaria').html(html);
                                       
                }
                else{
                    console.log("no hay datos");
                }

            });
            function prueba(){alert('prueba')};
        }

        /*selectedIndex capturar cambios*/ 
        function error(err){
            console.log("error ="+err.message);
        }
        

        </script>


        <title>SOS PY</title>
    </head>
    <body>

        <div class="container-fluid" id="cn">
            <img src="img/SOSPY.png" class="rounded mx-auto d-block" alt="Responsive image" id="foto">            
        </div>
       
        <div class="container-fluid">
           <h1>
                Bienvenido a<br\>
                tu aplicaci√≥n de emergencia<br\>
          </h1>
            <div id="contenido"></div>
            

            <hr>

            <h2>Seleccione su:</h2><br>
            <select class="custom-select" id="departamento" onchange="listarComisariaTodo()">
              <option selected>Departamento</option>

            </select>

            <br><br>

            <select class="custom-select clase" id="comisaria">
              <option selected >Dependencia Cercana</option>

            </select>
        </div>

       
            <button class="btn btn-danger siguiente" type="button" id="siguiente">
                <a href="index2.html"></a>
                <i class="fa fa-angle-right" aria-hidden="true"></i>
            </button>

        
        <script src="js/jquery-3.3.1.slim.min.js"></script>
        <script src="js/popper.min.js"></script>
        <script src="js/bootstrap.min.js"></script>

    </body>
</html>



